#!/usr/bin/env python2.7
import os, sys

import larp
import larp.larp_config as config
import larp.larp_usage as usage

from termcolor import colored

cfg_data = None
silent = False
verbose = False
arg = None

try:
    arg = sys.argv[1]
    if arg == "-v":
        verbose = True
        arg = sys.argv[2]
except:
    pass

#-----------------------------------------

if arg == "-cfg" or arg == "-c":
    config.configure(verbose).gen_config_wiz()
if arg == "-s" or arg == "--silent":
    silent = True
if arg == "-man" or arg == "-h":
    if arg == "-man":
        usage.man()
    else:
        usage.usage()
    sys.exit(0)

#-----------------------------------------

if os.geteuid() != 0:
    print >> sys.stderr, colored("[!] RUN THE PROGRAM AS ROOT!", "red")
    usage.usage()
    sys.exit(-1)

#-----------------------------------------

while cfg_data == None:
    cfg_data = config.configure(verbose).configure()
    if cfg_data == None:
        print colored("[!] CFG File Missing do you wish to generate one?", 'red')
        a = raw_input('[Y/n]')
        if a == 'Y' or a == 'y':
            config.configure(verbose).gen_config_wiz()
        else:
            sys.exit(-1)

if verbose:
    print "config -> ",
    print cfg_data

#----------------------------------------

larp.larp(cfg=cfg_data, silent=silent).main()
